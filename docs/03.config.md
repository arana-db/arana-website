---
sidebar_position: 3
---

# Config

## YAML Config

### Bootstrap

```yaml
config:
  name: file #配置文件模式：file, etcd
  options: #配置文件参数

# 示例：
config:
  name: etcd
  options:
    endpoints: "http://localhost:2379"
```

### Config

```yaml
kind: ConfigMap
apiVersion: "1.0"
metadata:
  name: arana-config
data:
  listeners:
    - protocol_type: mysql
      server_version: 5.7.0
      socket_address:
        address: 0.0.0.0
        port: 13306

  tenants:
    - name: arana
      users:
        - username: root
          password: "123456"
        - username: arana
          password: "123456"

  clusters:
    - name: employees
      type: mysql
      sql_max_limit: -1
      tenant: arana
      parameters:
        max_allowed_packet: 256M
      groups:
        - name: employees_0000
          nodes:
            - name: node0
              host: arana-mysql
              port: 3307
              username: root
              password: "123456"
              database: employees_0000
              weight: r10w10
              parameters:
        - name: employees_0001
          nodes:
            - name: node1
              host: arana-mysql
              port: 3307
              username: root
              password: "123456"
              database: employees_0001
              weight: r10w10
        - name: employees_0002
          nodes:
            - name: node2
              host: arana-mysql
              port: 3307
              username: root
              password: "123456"
              database: employees_0002
              weight: r10w10
        - name: employees_0003
          nodes:
            - name: node3
              host: arana-mysql
              port: 3307
              username: root
              password: "123456"
              database: employees_0003
              weight: r10w10

  sharding_rule:
    tables:
      - name: employees.student
        allow_full_scan: true
        sequence:
          type: snowflake
          option:
        db_rules:
          - column: uid
            type: scriptExpr
            expr: parseInt($value % 32 / 8)
        tbl_rules:
          - column: uid
            type: scriptExpr
            expr: $value % 32
            step: 32
        topology:
          db_pattern: employees_${0000..0003}
          tbl_pattern: student_${0000..0031}
        attributes:
          sqlMaxLimit: -1
```

## Config Center

### 导入配置

- 修改 `arana/conf/bootstrap.yaml` 配置如下，以 `etcd` 配置中心为例：
```yaml
config:
   name: etcd
   options:
     endpoints: "http://localhost:2379"
```

- 修改 `arana/conf/config.yaml` 配置文件，调整为正确配置内容；
- 启动 `etcd` 服务，确保 `etcd` 服务可以正常连通；
- 通过 `arana` 可执行文件导入配置；
```shell
./arana import -c ./conf/bootstrap.yaml -s ./conf/config.yaml
```

### 配置中心说明
- /arana-db/config/data/dataSourceClusters
```json
[{"name":"employees","type":"mysql","sql_max_limit":-1,"tenant":"arana","parameters":{"max_allowed_packet":"256M"},"groups":[{"name":"employees_0000","nodes":[{"name":"node0","host":"arana-mysql","port":3307,"username":"root","password":"123456","database":"employees_0000","parameters":null,"weight":"r10w10"}]},{"name":"employees_0001","nodes":[{"name":"node1","host":"arana-mysql","port":3307,"username":"root","password":"123456","database":"employees_0001","parameters":null,"weight":"r10w10"}]},{"name":"employees_0002","nodes":[{"name":"node2","host":"arana-mysql","port":3307,"username":"root","password":"123456","database":"employees_0002","parameters":null,"weight":"r10w10"}]},{"name":"employees_0003","nodes":[{"name":"node3","host":"arana-mysql","port":3307,"username":"root","password":"123456","database":"employees_0003","parameters":null,"weight":"r10w10"}]}]}]
```

- /arana-db/config/data/listeners
```json
[{"protocol_type":"mysql","socket_address":{"address":"0.0.0.0","port":13306},"server_version":"5.7.0"}]
```

- /arana-db/config/data/shardingRule
```json
{"tables":[{"name":"employees.student","sequence":{"type":"snowflake","option":null},"allow_full_scan":true,"db_rules":[{"column":"uid","type":"scriptExpr","expr":"parseInt($value % 32 / 8)","step":0}],"tbl_rules":[{"column":"uid","type":"scriptExpr","expr":"$value % 32","step":32}],"topology":{"db_pattern":"employees_${0000..0003}","tbl_pattern":"student_${0000..0031}"},"shadow_topology":null,"attributes":{"sqlMaxLimit":"-1"}}]}
```

- /arana-db/config/data/tenants
```json
[{"name":"arana","users":[{"username":"root","password":"123456"},{"username":"arana","password":"123456"}]}]
```